<div class="modal-wrapper">
  <ion-header>
    <ion-toolbar color="light">
      <ion-buttons slot="start">
        <ion-title>
          <b> {{ isEditMode ? "Update" : "Create" }} Resource</b>
        </ion-title>
      </ion-buttons>
      <ion-buttons slot="end">
        <ion-button fill="clear" (click)="setOpen(false)">
          <ion-icon name="close-outline" class="icon-medium"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-toolbar>
  </ion-header>

  <ion-content>
    <form [formGroup]="resourceForm">
      <ion-grid>
        <ion-row>
          <!-- Type Dropdown -->
          <ion-col size="6">
            <ion-item
              class="custom-item"
              [class.invalid]="isInvalid('resourceType')"
              [class.valid]="isValid('resourceType')"
              lines="none"
            >
              <ion-select
                formControlName="resourceType"
                label="Type"
                [(ngModel)]="selectedType"
                labelPlacement="floating"
                class="label-texts"
                interface="popover"
                placeholder="Select Type"
                (ionChange)="ionSelectChange()"
              >
                <ion-select-option value="TECH_STACK"
                  >Technologies</ion-select-option
                >
                <ion-select-option value="PROJECT">Projects</ion-select-option>
              </ion-select>
            </ion-item>
          </ion-col>

          <!-- Name Auto-Select -->
          <ion-col size="6">
            <ion-row>
              <!-- <ion-label class="ion-margin">Project Name</ion-label> -->
              <ion-searchbar
                [(ngModel)]="projectSearch"
                [debounce]="300"
                formControlName="name"
                (ionClear)="clearProjectSearch()"
                (ionInput)="onProjectTyping()"
                placeholder="Select"
                [disabled]="!selectedType"
              >
              </ion-searchbar>
            </ion-row>

            <ion-row *ngIf="projectSearch && !projectSelected">
              <ion-col size="12">
                <ion-list class="scroll-list" *ngIf="filteredNames.length">
                  <ion-item
                     *ngFor="let project of filterItems(filteredNames, projectSearch, projectSelected)"
                    button
                    lines="none"
                    (click)="selectProject(project)"
                  >
                    <ion-label>{{ project}}</ion-label>
                  </ion-item>
                </ion-list>
              </ion-col>
            </ion-row>
          </ion-col>
        </ion-row>

        <!-- <ion-row>
        <ion-col size="8">
          <ion-label class="ion-margin">Project Name</ion-label>
          <ion-searchbar
            [(ngModel)]="projectSearch"
            [debounce]="300"
            (ionClear)="clearProjectSearch()"
            (ionInput)="onProjectTyping()"
          >
          </ion-searchbar>
        </ion-col>
      </ion-row> -->

        <ion-row>
          <!-- Onsite -->
          <ion-col size="6">
            <ion-item
              class="custom-item"
              [class.invalid]="isInvalid('onsite')"
              [class.valid]="isValid('onsite')"
              lines="none"
            >
              <ion-input
                formControlName="onsite"
                label="Onsite"
                labelPlacement="floating"
                class="label-texts"
                placeholder="Enter onsite count"
                [clearOnEdit]="true"
                type="number"
              >
              </ion-input>
            </ion-item>

            @if (isInvalid('onsite')) {
            <ion-text color="danger" class="error-message">
              <p>Onsite value is required.</p>
            </ion-text>
            }
          </ion-col>

          <!-- Offsite -->
          <ion-col size="6">
            <ion-item
              class="custom-item"
              [class.invalid]="isInvalid('offsite')"
              [class.valid]="isValid('offsite')"
              lines="none"
            >
              <ion-input
                formControlName="offsite"
                label="Offsite"
                labelPlacement="floating"
                class="label-texts"
                placeholder="Enter offsite count"
                [clearOnEdit]="true"
                type="number"
              >
              </ion-input>
            </ion-item>

            @if (isInvalid('offsite')) {
            <ion-text color="danger" class="error-message">
              <p>Offsite value is required.</p>
            </ion-text>
            }
          </ion-col>
        </ion-row>
      </ion-grid>
    </form>
  </ion-content>

  <ion-footer>
    <ion-toolbar>
      <!-- <ion-icon name="copy" slot="start" size="medium" title="Copy from previous Sprint" class="cursor"
        (click)="copyFromPreviousSprint()">
      </ion-icon>
      <span>Copy</span> -->
      <ion-buttons slot="end">
        <ion-button class="close" (click)="setOpen(false)">Close</ion-button>

        <ion-button class="save" (click)="SubmitForm()">
          {{ isEditMode ? "Update" : "Save" }}
        </ion-button>
      </ion-buttons>
    </ion-toolbar>
  </ion-footer>
</div>
<!-- <div class="loader-overlay" *ngIf="(isLoading$ | async)">
    <ion-spinner name="crescent"></ion-spinner>
</div> -->
