import{a as S}from"./chunk-2YQHNUEK.js";import"./chunk-YIKJSF4E.js";import{c as q,d as K,e as $}from"./chunk-IPEDQWQT.js";import{A,B as J,C as M,Ca as fe,D as z,Da as he,E as R,F as L,G as W,I as B,S as H,T as X,X as Q,Y,ba as Z,ca as ee,da as te,ea as ie,fa as oe,ga as ne,ia as re,ja as ae,oa as le,qa as se,ra as me,ta as pe,ua as ce,v as d,va as de,w as O,x as V,xa as ue,y as G}from"./chunk-LCAD2BME.js";import"./chunk-JBQ62U6C.js";import"./chunk-WANN5XP4.js";import{f as D,g as T,j as N,k as P,v as j}from"./chunk-X2ZI6WJC.js";import"./chunk-OKAK23HW.js";import"./chunk-3ZBN7PZY.js";import"./chunk-HC6MZPB3.js";import"./chunk-SV2ZKNWA.js";import"./chunk-XGS4H5SF.js";import"./chunk-RS5W3JWO.js";import"./chunk-2U2U3MQ2.js";import"./chunk-WQJ4QNRK.js";import{Ab as F,Bb as w,La as l,Ma as k,U as x,_ as C,_a as f,ab as p,bb as c,cb as I,db as i,ea as s,eb as o,fb as g,jb as E,kb as h,la as b,lb as v,tb as n,va as y,vb as U,wa as _}from"./chunk-6BICWZAS.js";import"./chunk-QA7HW7QI.js";import"./chunk-RKR3YXXE.js";import"./chunk-UYQ7EZNZ.js";import"./chunk-7D6K5XYM.js";import"./chunk-OBXDPQ3V.js";import"./chunk-IDKUYNE4.js";import"./chunk-MCRJI3T3.js";import"./chunk-BAKMWPBW.js";import"./chunk-MHPMO34D.js";import"./chunk-R52CLOUQ.js";import"./chunk-OUUNPNPW.js";import"./chunk-CPYOLLZG.js";import"./chunk-B7AAHVZY.js";import"./chunk-3IVKBF6N.js";import"./chunk-NMYJD6OP.js";import"./chunk-C5RQ2IC2.js";import"./chunk-SV7S5NYR.js";import"./chunk-FP7EQKGB.js";var ve=(()=>{class r{constructor(){this.http=s(P),this.url=q.PROJect_DETAILS}getDates(){return this.http.get(this.url)}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275prov=C({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function _e(r,u){if(r&1&&(i(0,"ion-select-option",38),n(1),o()),r&2){let t=u.$implicit;p("value",t),l(),U(" ",t," ")}}function Ee(r,u){r&1&&(i(0,"ion-text",33)(1,"p"),n(2,"Comments is required"),o()())}function Se(r,u){if(r&1){let t=E();i(0,"ion-col",34)(1,"ion-icon",39),h("click",function(){y(t);let a=v().index,m=v();return _(m.removeUpdate(a))}),o()()}}function xe(r,u){r&1&&g(0,"hr")}function Ce(r,u){if(r&1){let t=E();i(0,"div",11)(1,"ion-row")(2,"ion-col",12)(3,"ion-item",13)(4,"ion-label",14),n(5,"Week Range"),o(),i(6,"ion-select",15),f(7,_e,2,2,"ion-select-option",16),o()()(),i(8,"ion-col",12)(9,"ion-item",13)(10,"ion-label",14),n(11,"Task Type"),o(),i(12,"ion-select",17)(13,"ion-select-option",18),n(14,"Task"),o(),i(15,"ion-select-option",19),n(16,"Summary"),o(),i(17,"ion-select-option",20),n(18,"Key Accomplishments"),o()()()(),i(19,"ion-col",12)(20,"ion-item",13)(21,"ion-label",14),n(22,"Projects"),o(),i(23,"ion-select",21)(24,"ion-select-option",18),n(25,"Customer 360"),o(),i(26,"ion-select-option",19),n(27,"Spp Canada"),o(),i(28,"ion-select-option",20),n(29,"Initio"),o(),i(30,"ion-select-option",22),n(31,"UX"),o()()()()(),i(32,"ion-row")(33,"ion-col",12)(34,"ion-item",13)(35,"ion-label",14),n(36,"Employees"),o(),i(37,"ion-select",23),n(38," > "),i(39,"ion-select-option",24),n(40,"Alice Johnson"),o(),i(41,"ion-select-option",25),n(42,"Bob Smith"),o(),i(43,"ion-select-option",26),n(44,"Charlie Lee"),o(),i(45,"ion-select-option",27),n(46,"Diana Cruz"),o(),i(47,"ion-select-option",28),n(48,"Ethan Patel"),o()()()(),i(49,"ion-col",12)(50,"ion-item",13)(51,"ion-label",14),n(52,"Status"),o(),i(53,"ion-select",29),n(54," > "),i(55,"ion-select-option",18),n(56,"Progress"),o(),i(57,"ion-select-option",19),n(58,"Pending"),o(),i(59,"ion-select-option",20),n(60,"Completed"),o(),i(61,"ion-select-option",22),n(62,"Blocker"),o()()()()(),i(63,"ion-row",30)(64,"ion-col",31)(65,"ion-item",13),g(66,"ion-textarea",32),o(),f(67,Ee,3,0,"ion-text",33),o()(),i(68,"ion-row")(69,"ion-col",34)(70,"ion-icon",35),h("click",function(){y(t);let a=v();return _(a.addMore())}),o()(),f(71,Se,2,0,"ion-col",36),o(),f(72,xe,1,0,"hr",37),o()}if(r&2){let t=u.index,e=v();p("formGroupName",t),l(3),c("invalid",e.isInvalid("weekRange"))("valid",e.isValid("weekRange")),l(4),p("ngForOf",e.weekOptions),l(2),c("invalid",e.isInvalid("status"))("valid",e.isValid("status")),l(11),c("invalid",e.isInvalid("status"))("valid",e.isValid("status")),l(14),c("invalid",e.isInvalid("status"))("valid",e.isValid("status")),l(16),c("invalid",e.isInvalid("status"))("valid",e.isValid("status")),l(15),c("invalid",e.isInvalid("Comments"))("valid",e.isValid("Comments")),l(2),I(67,e.isInvalid("Comments")?67:-1),l(4),p("ngIf",t>0),l(),p("ngIf",e.weeklyUpdates.length>1)}}var Le=(()=>{class r{ngOnInit(){this.getProjetcDates(),this.loginStore.user$.pipe(x(t=>{console.log(t),this.userInfo=t},()=>{})).subscribe(),console.log("userList",this.userInfo),this.summary.getDetails(),this.summary.projects$.subscribe(t=>{var e=t.find(a=>a.project_name===this.userInfo.projectName);this.projectInfo=e?.id,console.log("filter",e),console.log(t)})}getProjetcDates(){this.employeeupdate.getDates().subscribe(t=>{this.Dates=t,console.log(this.Dates)})}constructor(t){this.fb=t,this.employeeupdate=s(ve),this.Dates=[],this.dateError=null,this.summary=s(S),this.loginStore=s($),this.loginService=s(K),this.router=s(j),this.projectInfo="",this.weekValue="WEEK:16-June-2025 To 20-June-2025",this.modalCtrl=s(fe),this.weekOptions=["WEEK:16-June-2025 To 20-June-2025","WEEK:08-June-2025 To 14-June-2025","WEEK:01-June-2025 To 07-June-2025"],this.initializeForm()}initializeForm(){this.employeeUpdateForm=this.fb.group({summary:[""],comments:[""],weeklyUpdates:this.fb.array([this.createWeeklyUpdateGroup()])})}validateDates(){let t=this.employeeUpdateForm.get("startDate")?.value,e=this.employeeUpdateForm.get("endDate")?.value;if(!t||!e)return this.dateError=null,!0;let a=new Date(t),m=new Date(e);return a>m?(this.dateError="Start date cannot be greater than end date",!1):(this.dateError=null,!0)}createWeeklyUpdateGroup(){let t=this.fb.group({startDate:["",[d.required]],endDate:["",[d.required]],task:["",[d.required,d.minLength(3)]],status:["",[d.required]],weekRange:[this.weekOptions[0],d.required]});return t.get("endDate")?.valueChanges.subscribe(()=>{let e=t.get("startDate")?.value,a=t.get("endDate")?.value;if(!e||!a)return this.dateError=null,!0;let m=new Date(e),ge=new Date(a);return m>ge?(this.dateError="Start date cannot be greater than end date",!1):(this.dateError=null,!0)}),t}get weeklyUpdates(){return this.employeeUpdateForm.get("weeklyUpdates")}addMore(){this.weeklyUpdates.push(this.createWeeklyUpdateGroup())}removeUpdate(t){this.weeklyUpdates.removeAt(t)}onSubmit(){if(this.employeeUpdateForm.valid){let t={projectId:"",date:this.employeeUpdateForm.value.weeklyUpdates[0].startDate,task:this.employeeUpdateForm.value.weeklyUpdates[0].task},e={employee_id:this.userInfo.id,project_id:this.projectInfo,employee_name:this.userInfo.firstName,summary:this.employeeUpdateForm.value.summary,daily_updates:this.employeeUpdateForm.value.weeklyUpdates,projectName:this.userInfo.projectName,techstack:this.userInfo.techstack};this.summary.addEmployeeTask(e),console.log("Form submitted:",this.employeeUpdateForm.value)}else this.markFormGroupTouched(this.employeeUpdateForm)}markFormGroupTouched(t){Object.values(t.controls).forEach(e=>{e.markAsTouched(),(e instanceof G||e instanceof L)&&this.markFormGroupTouched(e)})}setOpen(t){this.employeeUpdateForm.reset(),this.router.navigate(["/summary"])}isInvalid(t){let e=this.employeeUpdateForm.get(t);return!!(e&&e.invalid&&e.touched)}isValid(t){let e=this.employeeUpdateForm.get(t);return!!(e&&e.valid&&e.touched)}static{this.\u0275fac=function(e){return new(e||r)(k(W))}}static{this.\u0275cmp=b({type:r,selectors:[["app-employee-update"]],standalone:!0,features:[F([S]),w],decls:21,vars:2,consts:[[1,"modal-wrapper"],["color","light"],["slot","end"],["fill","clear",3,"click"],["name","close-outline",1,"icon-medium"],[2,"height","calc(100vh - 32vh)"],[1,"register-form",3,"ngSubmit","formGroup"],["formArrayName","weeklyUpdates"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"close",3,"click"],[1,"save"],[3,"formGroupName"],["size","4"],["lines","none",1,"custom-item"],["position","stacked",1,"label-texts"],["formControlName","weekRange","interface","popover",1,"label-texts"],[3,"value",4,"ngFor","ngForOf"],["formControlName","status","interface","popover","placeholder","Select Type",1,"label-texts"],["value","Progress"],["value","Pending"],["value","Completed"],["formControlName","status","interface","popover","placeholder","Select Project",1,"label-texts"],["value","Blocker"],["formControlName","status","interface","popover","placeholder","Select Employee",1,"label-texts"],["value","Alice Johnson"],["value","Bob Smith"],["value","Charlie Lee"],["value","Diana Cruz"],["value","Ethan Patel"],["formControlName","status","interface","popover","multiple","true","placeholder","Select Status",1,"label-texts"],[1,"ion-align-items-center"],["size","8"],["formControlName","Comments","label","Comments","labelPlacement","floating","placeholder","Enter Comments","rows","3",1,"label-texts"],["color","danger",1,"error-message"],["size","1",1,"ion-text-center"],["name","add-outline","color","primary",2,"cursor","pointer","font-size","24px","margin-top","6px",3,"click"],["size","1","class","ion-text-center",4,"ngIf"],[4,"ngIf"],[3,"value"],["name","trash-outline","color","danger",2,"cursor","pointer","font-size","24px","margin-top","6px",3,"click"]],template:function(e,a){e&1&&(i(0,"div",0)(1,"ion-header")(2,"ion-toolbar",1)(3,"ion-title")(4,"b"),n(5,"Project Status Update"),o()(),i(6,"ion-buttons",2)(7,"ion-button",3),h("click",function(){return a.setOpen(!1)}),g(8,"ion-icon",4),o()()()(),i(9,"ion-content",5)(10,"form",6),h("ngSubmit",function(){return a.onSubmit()}),i(11,"ion-grid")(12,"div",7),f(13,Ce,73,29,"div",8),o()()()(),i(14,"ion-footer")(15,"ion-toolbar")(16,"ion-buttons",2)(17,"ion-button",9),h("click",function(){return a.setOpen(!1)}),n(18,"Close"),o(),i(19,"ion-button",10),n(20," Submit All Updates "),o()()()()()),e&2&&(l(10),p("formGroup",a.employeeUpdateForm),l(3),p("ngForOf",a.weeklyUpdates.controls))},dependencies:[he,Q,Y,Z,ee,te,ie,oe,ne,re,ae,le,se,me,pe,ce,de,ue,H,X,N,D,T,B,A,O,V,J,R,M,z],styles:[".textarea-fill-outline[_ngcontent-%COMP%]{margin-top:10px!important}[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}ion-grid[_ngcontent-%COMP%]{margin-top:15px}"]})}}return r})();export{Le as EmployeeUpdateComponent};
