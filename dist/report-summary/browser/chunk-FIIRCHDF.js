import{a as we}from"./chunk-YIKJSF4E.js";import{a as N}from"./chunk-JNKSMFVL.js";import{a as F,b as ie,c as v}from"./chunk-IPEDQWQT.js";import{A as Q,B as W,Ca as Fe,Da as be,E as X,G as Y,I as Z,K as ee,P as te,Q as T,S as oe,T as ne,X as re,Y as ae,ba as le,ca as se,da as de,ea as me,fa as ce,ga as pe,ha as ue,ia as he,ja as ge,oa as fe,qa as ve,ra as Se,sa as _e,ta as Ce,v as u,va as Ee,w as J,x as K,xa as Ie}from"./chunk-LCAD2BME.js";import{f as V,g as L,i as U,j as B,k as G,t as z,v as H}from"./chunk-X2ZI6WJC.js";import{Ab as $,Bb as A,Eb as R,Fb as P,J as E,La as a,Ma as j,S as x,U as I,Ua as _,Vb as q,_ as S,_a as c,ab as p,bb as g,cb as m,db as r,ea as s,eb as o,fb as h,kb as C,la as M,lb as w,tb as l,vb as y,wb as D}from"./chunk-6BICWZAS.js";import{a as k}from"./chunk-FP7EQKGB.js";var ye=(()=>{class t{constructor(){this.http=s(G),this.apiUrl=v.REGISTRATION_DETAILS}registerUser(i){return console.log(i),this.http.post(this.apiUrl,i)}getUsers(){return this.http.get(this.apiUrl)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275prov=S({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var b=(()=>{class t extends te{constructor(){super({register:[],loading:!1,error:null}),this._accountCreateStatus=_(null),this.accountCreateStatus=this._accountCreateStatus.asReadonly(),this.register=s(ye),this.sharedservice=s(ie),this.toast=s(F),this.register$=this.select(i=>i.register),this.loading$=this.select(i=>i.loading),this.error$=this.select(i=>i.error),this.addregister=this.effect(i=>i.pipe(E(n=>(this.patchState({loading:!0,error:null}),this.sharedservice.postData(v.CREATE_PERSON,n).pipe(I({next:e=>{this.patchState({register:[e],loading:!1}),this._accountCreateStatus.set("success")},error:()=>{this.patchState({loading:!1,error:""}),this._accountCreateStatus.set("error")}})))))),this.getRegisterData=this.effect(i=>i.pipe(I(()=>this.patchState({loading:!0,error:null})),x(n=>this.sharedservice.getData(`${v.GET_MANAGRE_DETAILS}/${n}`).pipe(T(e=>{this.patchState({register:e.data,loading:!1})},e=>{this.patchState({loading:!1,error:"Failed to fetch accounts"})}))))),this.updateperson=this.effect(i=>i.pipe(E(({id:n,data:e})=>(this.patchState({loading:!0,error:null}),this.sharedservice.patchData(`${v.CREATE_PERSON}/${n}`,e).pipe(I({next:f=>{this._accountCreateStatus.set("update"),this.patchState({loading:!1})},error:()=>{this._accountCreateStatus.set("error"),this.patchState({loading:!1,error:"Failed to update account"}),this.toast.show("error","Update failed!")}})))))),this.deleteProject=this.effect(i=>i.pipe(E(n=>this.sharedservice.deleteData(`${v.CREATE_PERSON}/${n}`).pipe(T(()=>{this._accountCreateStatus.set("deleted"),this.role==="manager"?(this.getRegisterData("manager"),this.getRegisterData("employee")):this.role==="employee"&&this.getRegisterData("employee"),this.toast.show("success","Account deleted successfully!")},e=>{this.toast.show("error","Failed to delete account!")})))))}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275prov=S({token:t,factory:t.\u0275fac})}}return t})();var Re=(()=>{class t{constructor(){}isInvalid(i,n){let e=n.get(i);return!!(e&&e.invalid&&e.touched)}isValid(i,n){let e=n.get(i);return!!(e&&e.valid&&e.touched)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275prov=S({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Pe(t,d){t&1&&(r(0,"ion-text",10)(1,"p"),l(2,"Field is required."),o()())}function Te(t,d){t&1&&(r(0,"ion-text",10)(1,"p"),l(2,"Last Name is required"),o()())}function Ne(t,d){t&1&&(r(0,"p"),l(1,"Email is required."),o())}function Oe(t,d){t&1&&(r(0,"p"),l(1,"Invalid email format."),o())}function ke(t,d){if(t&1&&(r(0,"ion-text",10),c(1,Ne,2,0,"p")(2,Oe,2,0,"p"),o()),t&2){let i,n,e=w();a(),m(1,!((i=e.registrationForm.get("email"))==null||i.errors==null)&&i.errors.required?1:-1),a(),m(2,!((n=e.registrationForm.get("email"))==null||n.errors==null)&&n.errors.email?2:-1)}}function xe(t,d){t&1&&(r(0,"ion-text",10)(1,"p"),l(2,"Employee ID is required."),o()())}function Me(t,d){t&1&&(r(0,"p"),l(1,"Password is required."),o())}function je(t,d){t&1&&(r(0,"p"),l(1,"Minimum 8 characters required"),o())}function De(t,d){if(t&1&&(r(0,"ion-text",10),c(1,Me,2,0,"p")(2,je,2,0,"p"),o()),t&2){let i,n,e=w();a(),m(1,!((i=e.registrationForm.get("password"))==null||i.errors==null)&&i.errors.required?1:-1),a(),m(2,!((n=e.registrationForm.get("password"))==null||n.errors==null)&&n.errors.minlength?2:-1)}}function $e(t,d){t&1&&(r(0,"ion-text",10)(1,"p"),l(2,"Confirm Password is required."),o()())}function Ae(t,d){t&1&&(r(0,"ion-text",16)(1,"p"),l(2,"Passwords do not match."),o()())}function qe(t,d){if(t&1&&(r(0,"ion-select-option",32),l(1),o()),t&2){let i=d.$implicit;p("value",i.projectId),a(),y(" ",i.projectName," ")}}function Ve(t,d){t&1&&(r(0,"ion-text",10)(1,"p"),l(2,"At least one project must be selected."),o()())}function Le(t,d){t&1&&(r(0,"ion-text",10)(1,"p"),l(2,"Tech stack selection is required."),o()())}function Ue(t,d){t&1&&(r(0,"div",33),h(1,"ion-spinner",34),o())}var _t=(()=>{class t{constructor(i){this.navParams=i,this.teamList=_([]),this.teamListData=[],this.projectStore=s(N),this.projectList$=this.projectStore.team$,this.fb=s(Y),this.isEditMode=!1,this.teamRegisterList=_([]),this.getRegisterStore=s(b),this.teamRegisterList$=this.getRegisterStore.register$,this.validationService=s(Re),this.store=s(b),this.projects=[],this.isModalOpen=!1,this.summary=s(we),this.toast=s(F),this.router=s(H),this.error$=this.store.error$,this.loading$=this.store.loading$,this.modalCtrl=s(Fe),this.register$=this.store.register$,this.isLoading$=this.store.select(n=>n.loading),this.routering=s(z),this.accountStatusEffect=q(()=>{let n=this.store.accountCreateStatus();n==="success"?(this.setOpen(!1),this.toast.show("success","Account created successfully!")):n==="update"?(this.setOpen(!1),this.toast.show("success","Account updated successfully!")):n==="deleted"?this.toast.show("success","Account deleted successfully!"):n==="error"&&this.toast.show("error","Something went wrong!")})}ngOnInit(){this.role=this.navParams?.get("role"),this.roles=this.role?.toUpperCase(),this.projectStore.getTeam(),this.createForm(),this.editData&&(this.registrationForm?.patchValue(this.editData),console.log("TechStack in editData:",this.editData.techStack[0]),this.isEditMode=!0)}createForm(){this.registrationForm=this.fb.group({firstName:["",[u.required]],lastName:["",[u.required]],email:["",[u.required,u.email]],password:["",[u.required,u.minLength(8)]],confirmPassword:["",[u.required]],employeeCode:["",[u.required]],role:[{value:this.roles,disabled:!0}],projectIds:["",[u.required]],techStack:["",[u.required]]},{validators:this.passwordMatchValidator})}passwordMatchValidator(i){let n=i.get("password")?.value,e=i.get("confirmPassword")?.value;return n&&e&&n!==e?{passwordMismatch:!0}:null}onModalDismiss(){this.isModalOpen=!1,this.registrationForm.reset()}onCloseClick(){this.isModalOpen=!1,this.registrationForm.reset()}onSubmit(){if(this.registrationForm.valid){let i=k({},this.registrationForm.getRawValue());this.isEditMode&&this.editData?.personId?this.store.updateperson({id:this.editData.personId,data:i}):this.store.addregister(i)}else this.registrationForm.markAllAsTouched()}setOpen(i){this.modalCtrl.dismiss(),this.registrationForm.reset()}openModal(){this.router.navigate(["view-all-projects"])}static{this.\u0275fac=function(n){return new(n||t)(j(ee))}}static{this.\u0275cmp=M({type:t,selectors:[["app-register"]],inputs:{editData:"editData"},standalone:!0,features:[$([b,N]),A],decls:76,vars:57,consts:[[1,"modal-wrapper"],["color","light"],["slot","start"],["slot","end",1,"ion-no-padding"],["fill","clear",3,"click"],["name","close-outline",1,"icon-medium"],[3,"ngSubmit","formGroup"],["size","6"],["lines","none",1,"custom-item"],["formControlName","firstName","label","First Name","labelPlacement","floating","placeholder","Enter your first name",1,"label-texts",3,"clearOnEdit"],["color","danger",1,"error-message"],["formControlName","lastName","label","Last Name","labelPlacement","floating","placeholder","Enter your last name",1,"label-texts",3,"clearOnEdit"],["formControlName","email","label","Email","labelPlacement","stacked","placeholder","Enter your email",1,"label-texts",3,"clearOnEdit"],["formControlName","employeeCode","label","Employee ID","labelPlacement","floating","placeholder","Enter your employee ID",1,"label-texts",3,"clearOnEdit"],["formControlName","password","label","Password","labelPlacement","floating","placeholder","Enter your password",1,"label-texts",3,"clearOnEdit"],["formControlName","confirmPassword","label","Confirm Password","labelPlacement","floating","placeholder","Enter your password again",1,"label-texts",3,"clearOnEdit"],["color","danger"],["lines","none",1,"stack-dropdown","custom-item"],["position","stacked",1,"label-texts"],["interface","popover","multiple","true","formControlName","projectIds","placeholder","Select Project",1,"label-texts"],["class","label-texts",3,"value",4,"ngFor","ngForOf"],["formControlName","techStack","interface","popover","placeholder","Select Tech Stack",1,"label-texts"],["value","Frontend"],["value","Backend"],["value","FullStack"],["value","Testing"],["size","12"],["readonly","","label","Role","labelPlacement","floating","formControlName","role","type","text",1,"label-texts"],["slot","end",1,"ion-no-paddings"],[1,"close",3,"click"],[1,"save",3,"click"],["class","loader-overlay",4,"ngIf"],[1,"label-texts",3,"value"],[1,"loader-overlay"],["name","crescent"]],template:function(n,e){if(n&1&&(r(0,"div",0)(1,"ion-header")(2,"ion-toolbar",1)(3,"ion-title",2)(4,"b"),l(5),o()(),r(6,"ion-buttons",3)(7,"ion-button",4),C("click",function(){return e.setOpen(!1)}),h(8,"ion-icon",5),o()()()(),r(9,"ion-content")(10,"form",6),C("ngSubmit",function(){return e.onSubmit()}),r(11,"ion-grid")(12,"ion-row")(13,"ion-col",7)(14,"ion-item",8),h(15,"ion-input",9),o(),c(16,Pe,3,0,"ion-text",10),o(),r(17,"ion-col",7)(18,"ion-item",8),h(19,"ion-input",11),o(),c(20,Te,3,0,"ion-text",10),o()(),r(21,"ion-row")(22,"ion-col",7)(23,"ion-item",8),h(24,"ion-input",12),o(),c(25,ke,3,2,"ion-text",10),o(),r(26,"ion-col",7)(27,"ion-item",8),h(28,"ion-input",13),o(),c(29,xe,3,0,"ion-text",10),o()(),r(30,"ion-row")(31,"ion-col",7)(32,"ion-item",8),h(33,"ion-input",14),o(),c(34,De,3,2,"ion-text",10),o(),r(35,"ion-col",7)(36,"ion-item",8),h(37,"ion-input",15),o(),c(38,$e,3,0,"ion-text",10)(39,Ae,3,0,"ion-text",16),o()(),r(40,"ion-row")(41,"ion-col",7)(42,"ion-item",17)(43,"ion-label",18),l(44,"Projects"),o(),r(45,"ion-select",19),c(46,qe,2,2,"ion-select-option",20),R(47,"async"),o()(),c(48,Ve,3,0,"ion-text",10),o(),r(49,"ion-col",7)(50,"ion-item",17)(51,"ion-label",18),l(52,"Tech Stack"),o(),r(53,"ion-select",21)(54,"ion-select-option",22),l(55,"Frontend"),o(),r(56,"ion-select-option",23),l(57,"Backend"),o(),r(58,"ion-select-option",24),l(59,"Full Stack"),o(),r(60,"ion-select-option",25),l(61,"Testing"),o()()(),c(62,Le,3,0,"ion-text",10),o()(),r(63,"ion-row")(64,"ion-col",26)(65,"ion-item",8),h(66,"ion-input",27),o()()()()()(),r(67,"ion-footer")(68,"ion-toolbar")(69,"ion-buttons",28)(70,"ion-button",29),C("click",function(){return e.setOpen(!1)}),l(71,"Close"),o(),r(72,"ion-button",30),C("click",function(){return e.onSubmit()}),l(73),o()()()()(),c(74,Ue,2,0,"div",31),R(75,"async")),n&2){let f;a(5),D(" ",e.isEditMode?"Update":"Create"," ",e.role,""),a(5),p("formGroup",e.registrationForm),a(4),g("invalid",e.validationService.isInvalid("firstName",e.registrationForm))("valid",e.validationService.isValid("firstName",e.registrationForm)),a(),p("clearOnEdit",!0),a(),m(16,e.validationService.isInvalid("firstName",e.registrationForm)?16:-1),a(2),g("invalid",e.validationService.isInvalid("lastName",e.registrationForm))("valid",e.validationService.isValid("lastName",e.registrationForm)),a(),p("clearOnEdit",!0),a(),m(20,e.validationService.isInvalid("lastName",e.registrationForm)?20:-1),a(3),g("invalid",e.validationService.isInvalid("email",e.registrationForm))("valid",e.validationService.isValid("email",e.registrationForm)),a(),p("clearOnEdit",!0),a(),m(25,e.validationService.isInvalid("lastName",e.registrationForm)?25:-1),a(2),g("invalid",e.validationService.isInvalid("employeeCode",e.registrationForm))("valid",e.validationService.isValid("employeeCode",e.registrationForm)),a(),p("clearOnEdit",!0),a(),m(29,e.validationService.isInvalid("employeeCode",e.registrationForm)?29:-1),a(3),g("invalid",e.validationService.isInvalid("password",e.registrationForm))("valid",e.validationService.isValid("password",e.registrationForm)),a(),p("clearOnEdit",!0),a(),m(34,e.validationService.isInvalid("password",e.registrationForm)?34:-1),a(2),g("invalid",e.validationService.isInvalid("confirmPassword",e.registrationForm))("valid",e.validationService.isValid("confirmPassword",e.registrationForm)),a(),p("clearOnEdit",!0),a(),m(38,e.validationService.isInvalid("confirmPassword",e.registrationForm)?38:-1),a(),m(39,e.registrationForm.errors!=null&&e.registrationForm.errors.passwordMismatch&&((f=e.registrationForm.get("confirmPassword"))!=null&&f.touched)?39:-1),a(3),g("invalid",e.validationService.isInvalid("projectIds",e.registrationForm))("valid",e.validationService.isValid("projectIds",e.registrationForm)),a(4),p("ngForOf",P(47,53,e.projectList$)),a(2),m(48,e.validationService.isInvalid("projectIds",e.registrationForm)?48:-1),a(2),g("invalid",e.validationService.isInvalid("techStack",e.registrationForm))("valid",e.validationService.isValid("techStack",e.registrationForm)),a(12),m(62,e.validationService.isInvalid("techStack",e.registrationForm)?62:-1),a(11),y(" ",e.isEditMode?"Update":"Save"," "),a(),p("ngIf",P(75,55,e.isLoading$))}},dependencies:[be,re,ae,le,se,de,me,ce,pe,ue,he,ge,fe,ve,Se,_e,Ce,Ee,Ie,oe,ne,B,V,L,U,Z,Q,J,K,W,X],styles:[".modal-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;background:var(--ion-background-color, #fff);overflow:hidden;box-shadow:0 8px 16px #00000040}ion-grid[_ngcontent-%COMP%]{margin-top:15px}.ion-no-padding[_ngcontent-%COMP%]{margin-right:11px}.ion-no-paddings[_ngcontent-%COMP%]{margin-right:18px;gap:16px}.ion-content[_ngcontent-%COMP%]{margin-bottom:4px}ion-item.invalid[_ngcontent-%COMP%]{--background: #f3b7b7}ion-item.valid[_ngcontent-%COMP%]{--background: #f3f4f6}"]})}}return t})();export{b as a,_t as b};
