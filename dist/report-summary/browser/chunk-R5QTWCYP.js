import{a as h}from"./chunk-2YQHNUEK.js";import{a as re}from"./chunk-YIKJSF4E.js";import{A as P,B as O,Ca as ie,Da as oe,E as q,G as N,I as M,S as V,T as B,X as G,Y as A,ba as R,ca as L,da as z,ea as U,fa as W,ga as H,ha as $,ia as J,ja as K,oa as Q,qa as X,ra as Y,ta as Z,ua as ee,v as c,va as te,w as I,x as j,xa as ne}from"./chunk-LCAD2BME.js";import{f as D,j as E,v as x}from"./chunk-X2ZI6WJC.js";import{Ab as b,Bb as T,La as a,_a as s,ab as y,bb as C,cb as d,db as r,ea as g,eb as o,fb as v,kb as f,la as w,lb as k,tb as m,vb as F}from"./chunk-6BICWZAS.js";function ae(n,u){if(n&1&&(r(0,"ion-select-option",22),m(1),o()),n&2){let e=u.$implicit;y("value",e),a(),F(" ",e.projectName," ")}}function le(n,u){n&1&&(r(0,"p"),m(1,"Project selection is required"),o())}function me(n,u){if(n&1&&(r(0,"ion-text",14),s(1,le,2,0,"p"),o()),n&2){let e,i=k();a(),d(1,!((e=i.weekSummaryForm.get("project"))==null||e.errors==null)&&e.errors.required?1:-1)}}function ue(n,u){n&1&&(r(0,"p"),m(1,"Start date is required"),o())}function se(n,u){if(n&1&&(r(0,"ion-text",14),s(1,ue,2,0,"p"),o()),n&2){let e,i=k();a(),d(1,!((e=i.weekSummaryForm.get("startDate"))==null||e.errors==null)&&e.errors.required?1:-1)}}function de(n,u){n&1&&(r(0,"p"),m(1,"Start date is required"),o())}function ce(n,u){if(n&1&&(r(0,"ion-text",14),s(1,de,2,0,"p"),o()),n&2){let e,i=k();a(),d(1,!((e=i.weekSummaryForm.get("endDate"))==null||e.errors==null)&&e.errors.required?1:-1)}}function pe(n,u){n&1&&(r(0,"p"),m(1,"Upcoming Tasks are required"),o())}function _e(n,u){n&1&&(r(0,"p"),m(1,"Minimum length not met"),o())}function Se(n,u){if(n&1&&(r(0,"ion-text",14),s(1,pe,2,0,"p")(2,_e,2,0,"p"),o()),n&2){let e,i,t=k();a(),d(1,!((e=t.weekSummaryForm.get("upcomingTasks"))==null||e.errors==null)&&e.errors.required?1:-1),a(),d(2,!((i=t.weekSummaryForm.get("upcomingTasks"))==null||i.errors==null)&&i.errors.minlength?2:-1)}}var Ee=(()=>{class n{constructor(){this.projects=[],this.summary=g(re),this.route=g(x),this.modalCtrl=g(ie),this.store=g(h),this.dateError=null,this.fb=g(N)}ngOnInit(){this.weekSummaryForm=this.fb.group({project:[null,c.required],startDate:["",[c.required]],endDate:["",[c.required]],upcomingTasks:["",[c.required,c.minLength(10),c.maxLength(500)]]}),this.weekSummaryForm.get("endDate")?.valueChanges.subscribe(()=>{this.validateDates()}),this.getProjects()}get upcomingTasks(){return this.weekSummaryForm.get("upcomingTasks")}validateDates(){let e=this.weekSummaryForm.get("startDate")?.value,i=this.weekSummaryForm.get("endDate")?.value;if(!e||!i)return this.dateError=null,!0;let t=new Date(e),l=new Date(i);return t>l?(this.dateError="Start date cannot be greater than end date",!1):(this.dateError=null,!0)}getProjects(){this.summary.getProjectTitles().subscribe(e=>{this.projects=e})}setOpen(e){this.modalCtrl.dismiss(),this.weekSummaryForm.reset()}onSubmit(){if(!this.validateDates()){alert(this.dateError);return}if(this.weekSummaryForm.valid){console.log(this.weekSummaryForm.value);let e={project_id:this.weekSummaryForm.value.id,project_name:this.weekSummaryForm.value.project.projectname,start_date:this.weekSummaryForm.value.startDate,end_date:this.weekSummaryForm.value.endDate,upcomingTasks:this.weekSummaryForm.value.upcomingTasks,employees:[]};this.store.weeklyReport(e),this.route.navigate(["/dashboard"])}else this.weekSummaryForm.markAllAsTouched()}isInvalid(e){let i=this.weekSummaryForm.get(e);return!!(i&&i.invalid&&i.touched)}isValid(e){let i=this.weekSummaryForm.get(e);return!!(i&&i.valid&&i.touched)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=w({type:n,selectors:[["app-create-summary"]],standalone:!0,features:[b([h]),T],decls:41,vars:23,consts:[[1,"modal-wrapper"],["color","light"],["slot","start"],["slot","end"],["fill","clear",3,"click"],["name","close-outline",1,"icon-medium"],[1,"ion-padding"],[3,"ngSubmit","formGroup"],[1,"ion-margin-top"],["size","6"],["lines","none",1,"stack-dropdown","custom-item"],["position","stacked",1,"label-texts"],["interface","popover","formControlName","project","placeholder","Select Project",1,"label-texts"],[3,"value",4,"ngFor","ngForOf"],["color","danger",1,"error-message"],["lines","none",1,"custom-item"],["type","date","formControlName","startDate","label","Week Start Date","labelPlacement","floating","placeholder","Select start of week",1,"label-texts",3,"clearOnEdit"],["type","date","formControlName","endDate","label","Week End Date","labelPlacement","floating","placeholder","End of week",1,"label-texts",3,"ionBlur"],["size","12"],["formControlName","upcomingTasks","label","Upcoming Tasks","labelPlacement","floating","placeholder","Enter tasks...",1,"label-texts"],[1,"close",3,"click"],[1,"save",3,"click"],[3,"value"]],template:function(i,t){if(i&1&&(r(0,"div",0)(1,"ion-header")(2,"ion-toolbar",1)(3,"ion-buttons",2)(4,"ion-title")(5,"b"),m(6,"Create Summary"),o()()(),r(7,"ion-buttons",3)(8,"ion-button",4),f("click",function(){return t.setOpen(!1)}),v(9,"ion-icon",5),o()()()(),r(10,"ion-content",6)(11,"form",7),f("ngSubmit",function(){return t.onSubmit()}),r(12,"ion-grid",8)(13,"ion-row")(14,"ion-col",9)(15,"ion-item",10)(16,"ion-label",11),m(17,"Projects"),o(),r(18,"ion-select",12),s(19,ae,2,2,"ion-select-option",13),o()(),s(20,me,2,1,"ion-text",14),o(),r(21,"ion-col",9)(22,"ion-item",15),v(23,"ion-input",16),o(),s(24,se,2,1,"ion-text",14),o(),r(25,"ion-col",9)(26,"ion-item",15)(27,"ion-input",17),f("ionBlur",function(){return t.validateDates()}),o()(),s(28,ce,2,1,"ion-text",14),o()(),r(29,"ion-row")(30,"ion-col",18)(31,"ion-item",15),v(32,"ion-textarea",19),o(),s(33,Se,3,2,"ion-text",14),o()()()()(),r(34,"ion-footer")(35,"ion-toolbar")(36,"ion-buttons",3)(37,"ion-button",20),f("click",function(){return t.setOpen(!1)}),m(38,"Close"),o(),r(39,"ion-button",21),f("click",function(){return t.onSubmit()}),m(40,"Save"),o()()()()()),i&2){let l,p,_,S;a(11),y("formGroup",t.weekSummaryForm),a(4),C("invalid",t.isInvalid("project"))("valid",t.isValid("project")),a(4),y("ngForOf",t.projects),a(),d(20,(l=t.weekSummaryForm.get("project"))!=null&&l.invalid&&((l=t.weekSummaryForm.get("project"))!=null&&l.dirty||(l=t.weekSummaryForm.get("project"))!=null&&l.touched)?20:-1),a(2),C("invalid",t.isInvalid("startDate"))("valid",t.isValid("startDate")),a(),y("clearOnEdit",!0),a(),d(24,(p=t.weekSummaryForm.get("startDate"))!=null&&p.invalid&&((p=t.weekSummaryForm.get("startDate"))!=null&&p.dirty||(p=t.weekSummaryForm.get("startDate"))!=null&&p.touched)?24:-1),a(2),C("invalid",t.isInvalid("endDate"))("valid",t.isValid("endDate")),a(2),d(28,(_=t.weekSummaryForm.get("endDate"))!=null&&_.invalid&&((_=t.weekSummaryForm.get("endDate"))!=null&&_.dirty||(_=t.weekSummaryForm.get("endDate"))!=null&&_.touched)?28:-1),a(3),C("invalid",t.isInvalid("upcomingTasks"))("valid",t.isValid("upcomingTasks")),a(2),d(33,(S=t.weekSummaryForm.get("upcomingTasks"))!=null&&S.invalid&&((S=t.weekSummaryForm.get("upcomingTasks"))!=null&&S.dirty||(S=t.weekSummaryForm.get("upcomingTasks"))!=null&&S.touched)?33:-1)}},dependencies:[oe,G,A,R,L,z,U,W,H,$,J,K,Q,X,Y,Z,ee,te,ne,V,B,E,D,M,P,I,j,O,q],styles:[".modal-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;background:var(--ion-background-color, #fff);overflow:hidden;box-shadow:0 8px 16px #00000040}ion-grid[_ngcontent-%COMP%]{margin-top:10px}"]})}}return n})();export{Ee as a};
