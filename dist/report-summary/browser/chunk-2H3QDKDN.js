import{a as st,b as ut}from"./chunk-SQRLWJCJ.js";import{a as T,b as w,c as g}from"./chunk-OTROWG7S.js";import{A as j,B as G,Ba as N,Ca as lt,E as B,G as L,I as z,P as H,Q as O,T as J,X as K,Y as Q,ba as W,ca as X,da as Y,ea as Z,fa as tt,ga as et,ha as ot,ia as nt,oa as it,sa as at,ua as ct,v as M,w as V,wa as rt,x as U}from"./chunk-N46ENOW6.js";import{j as I}from"./chunk-ETXJNP3A.js";import"./chunk-4FRUSUS7.js";import"./chunk-QUJFQN2Y.js";import"./chunk-DUKM7HWQ.js";import"./chunk-XNADYL7L.js";import"./chunk-3GJ7TQK2.js";import"./chunk-4AJ5TPEV.js";import{Ab as F,Bb as y,J as A,La as a,S as P,U as v,Ua as $,Vb as q,_ as R,_a as m,ab as p,bb as D,cb as u,db as c,ea as r,eb as i,fb as S,kb as C,la as E,lb as b,tb as d,vb as x}from"./chunk-45DPJSY7.js";import"./chunk-JWVEZ7LL.js";import"./chunk-J4Z3Y3GN.js";import"./chunk-6IHAYORV.js";import"./chunk-L6PNYW6G.js";import"./chunk-WIKMGYWI.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-2ERNAIXA.js";import"./chunk-CKP3SGE2.js";import"./chunk-S25USO7A.js";import"./chunk-2VC3RZCL.js";import"./chunk-GX2ORJUI.js";import"./chunk-DMYLG4UX.js";import"./chunk-DDOBVB2Y.js";import"./chunk-TLQMGTG2.js";import"./chunk-M2X7KQLB.js";import"./chunk-3IVKBF6N.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import"./chunk-FP7EQKGB.js";var _=(()=>{class n extends H{constructor(){super({account:[],loading:!1,error:null}),this.sharedservice=r(w),this._accountCreateStatus=$(null),this.accountCreateStatus=this._accountCreateStatus.asReadonly(),this.toast=r(T),this.account$=this.select(t=>t.account),this.loading$=this.select(t=>t.loading),this.error$=this.select(t=>t.error),this.createAccount=this.effect(t=>t.pipe(A(e=>(this.patchState({loading:!0,error:null}),this.sharedservice.postData(g.CREATE_ACCOUNT,e).pipe(v({next:o=>{this.patchState({account:[o],loading:!1}),this._accountCreateStatus.set("success")},error:()=>{this.patchState({loading:!1,error:""}),this._accountCreateStatus.set("error")}})))))),this.getAccounts=this.effect(t=>t.pipe(v(()=>this.patchState({loading:!0,error:null})),P(()=>this.sharedservice.getData(g.CREATE_ACCOUNT).pipe(O(e=>{this.patchState({account:e.data,loading:!1})},e=>{this.patchState({loading:!1,error:"Failed to fetch accounts"}),this.toast.show("error","Failed to load accounts!")}))))),this.updateAccount=this.effect(t=>t.pipe(A(({id:e,data:o})=>(this.patchState({loading:!0,error:null}),this.sharedservice.patchData(`${g.CREATE_ACCOUNT}/${e}`,o).pipe(v({next:l=>{this._accountCreateStatus.set("update"),this.getAccounts(),this.patchState({loading:!1})},error:()=>{this._accountCreateStatus.set("error"),this.patchState({loading:!1,error:"Failed to update account"}),this.toast.show("error","Update failed!")}})))))),this.deleteAccount=this.effect(t=>t.pipe(A(e=>this.sharedservice.deleteData(`${g.CREATE_ACCOUNT}/${e}`).pipe(O(()=>{this._accountCreateStatus.set("deleted"),this.getAccounts()},o=>{this.toast.show("error","Failed to delete account!")})))))}static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275prov=R({token:n,factory:n.\u0275fac})}}return n})();function mt(n,h){n&1&&(c(0,"p"),d(1,"Account Name is required."),i())}function pt(n,h){n&1&&(c(0,"p"),d(1,"Minimum 3 characters required."),i())}function ht(n,h){if(n&1&&(c(0,"ion-text",10),m(1,mt,2,0,"p")(2,pt,2,0,"p"),i()),n&2){let t,e,o=b();a(),u(1,!((t=o.accountForm.get("accountName"))==null||t.errors==null)&&t.errors.required?1:-1),a(),u(2,!((e=o.accountForm.get("accountName"))==null||e.errors==null)&&e.errors.minlength?2:-1)}}function ft(n,h){n&1&&(c(0,"p"),d(1,"Start Date is required."),i())}function Ct(n,h){if(n&1&&(c(0,"ion-text",10),m(1,ft,2,0,"p"),i()),n&2){let t,e=b();a(),u(1,!((t=e.accountForm.get("accountStartDate"))==null||t.errors==null)&&t.errors.required?1:-1)}}function _t(n,h){n&1&&(c(0,"p"),d(1,"End Date is required."),i())}function St(n,h){if(n&1&&(c(0,"ion-text",10),m(1,_t,2,0,"p"),i()),n&2){let t,e=b();a(),u(1,!((t=e.accountForm.get("accountEndDate"))==null||t.errors==null)&&t.errors.required?1:-1)}}var k=(()=>{class n{constructor(){this.sharedservice=r(w),this.isModalOpen=!1,this.modalCtrl=r(N),this.fb=r(L),this.toast=r(T),this.isEditMode=!1,this.accountStore=r(_),this.accounts$=this.accountStore.account$,this.accountStatusEffect=q(()=>{let t=this.accountStore.accountCreateStatus();t==="success"?(this.setOpen(!1),this.toast.show("success","Account created successfully!")):t==="update"?(this.setOpen(!1),this.toast.show("success","Account updated successfully!")):t==="deleted"?this.toast.show("success","Account deleted successfully!"):t==="error"&&this.toast.show("error","Something went wrong!")})}ngOnInit(){this.creteForm(),this.accountStore.getAccounts(),this.editData&&(this.accountForm.patchValue(this.editData),this.isEditMode=!0)}creteForm(){this.accountForm=this.fb.group({accountName:["",M.required],accountStartDate:["",M.required],accountEndDate:["",M.required]})}setOpen(t){this.isModalOpen=t,t||(this.isEditMode=!1,this.accountForm.reset(),this.modalCtrl.dismiss())}SubmitForm(){if(this.accountForm.valid){let t=this.accountForm.value;this.isEditMode&&this.editData?.accountId?this.accountStore.updateAccount({id:this.editData.accountId,data:t}):this.accountStore.createAccount(t)}else this.accountForm.markAllAsTouched()}isInvalid(t){let e=this.accountForm.get(t);return!!(e&&e.invalid&&e.touched)}isValid(t){let e=this.accountForm.get(t);return!!(e&&e.valid&&e.touched)}static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275cmp=E({type:n,selectors:[["app-create-account"]],inputs:{editData:"editData"},standalone:!0,features:[F([_]),y],decls:34,vars:21,consts:[[1,"modal-wrapper"],["color","light"],["slot","start"],["slot","end"],["fill","clear",3,"click"],["name","close-outline",1,"icon-medium"],[3,"formGroup"],["size","6"],["lines","none",1,"custom-item"],["formControlName","accountName","label","Account Name","labelPlacement","floating","placeholder","Enter account name",1,"label-texts",3,"clearOnEdit"],["color","danger",1,"error-message"],["formControlName","accountStartDate","label","Start Date","labelPlacement","floating","type","date",1,"label-texts",3,"clearOnEdit"],["formControlName","accountEndDate","label","End Date","labelPlacement","floating","type","date",1,"label-texts",3,"clearOnEdit"],[1,"close",3,"click"],[1,"save",3,"click"]],template:function(e,o){if(e&1&&(c(0,"div",0)(1,"ion-header")(2,"ion-toolbar",1)(3,"ion-buttons",2)(4,"ion-title")(5,"b"),d(6),i()()(),c(7,"ion-buttons",3)(8,"ion-button",4),C("click",function(){return o.setOpen(!1)}),S(9,"ion-icon",5),i()()()(),c(10,"ion-content")(11,"form",6)(12,"ion-grid")(13,"ion-row")(14,"ion-col",7)(15,"ion-item",8),S(16,"ion-input",9),i(),m(17,ht,3,2,"ion-text",10),i(),c(18,"ion-col",7)(19,"ion-item",8),S(20,"ion-input",11),i(),m(21,Ct,2,1,"ion-text",10),i()(),c(22,"ion-row")(23,"ion-col",7)(24,"ion-item",8),S(25,"ion-input",12),i(),m(26,St,2,1,"ion-text",10),i()()()()(),c(27,"ion-footer")(28,"ion-toolbar")(29,"ion-buttons",3)(30,"ion-button",13),C("click",function(){return o.setOpen(!1)}),d(31,"Close"),i(),c(32,"ion-button",14),C("click",function(){return o.SubmitForm()}),d(33),i()()()()()),e&2){let l,s,f;a(6),x(" ",o.isEditMode?"Update":"Create"," Account"),a(5),p("formGroup",o.accountForm),a(4),D("invalid",o.isInvalid("accountName"))("valid",o.isValid("accountName")),a(),p("clearOnEdit",!0),a(),u(17,(l=o.accountForm.get("accountName"))!=null&&l.invalid&&((l=o.accountForm.get("accountName"))!=null&&l.dirty||(l=o.accountForm.get("accountName"))!=null&&l.touched)?17:-1),a(2),D("invalid",o.isInvalid("accountStartDate"))("valid",o.isValid("accountStartDate")),a(),p("clearOnEdit",!0),a(),u(21,(s=o.accountForm.get("accountStartDate"))!=null&&s.invalid&&((s=o.accountForm.get("accountStartDate"))!=null&&s.dirty||(s=o.accountForm.get("accountStartDate"))!=null&&s.touched)?21:-1),a(3),D("invalid",o.isInvalid("accountEndDate"))("valid",o.isValid("accountEndDate")),a(),p("clearOnEdit",!0),a(),u(26,(f=o.accountForm.get("accountEndDate"))!=null&&f.invalid&&((f=o.accountForm.get("accountEndDate"))!=null&&f.dirty||(f=o.accountForm.get("accountEndDate"))!=null&&f.touched)?26:-1),a(7),x(" ",o.isEditMode?"Update":"Save"," ")}},dependencies:[I,lt,K,Q,W,X,Y,Z,tt,et,ot,nt,it,at,ct,rt,J,z,j,V,U,G,B],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:70%}ion-grid[_ngcontent-%COMP%]{margin-top:10px}"]})}}return n})();var Jt=(()=>{class n{constructor(){this.modalController=r(N),this.label="Account",this.accountStore=r(_),this.columns=[{header:"Account Name",field:"accountName"},{header:"Start Date",field:"accountStartDate"},{header:"End Date",field:"accountEndDate"},{header:"Action",field:"action",type:["edit","delete"]}],this.accountStore.getAccounts(),this.accountList$=this.accountStore.account$}ngOnInit(){}handleRowAction(t){switch(t.type){case"create":this.loadCreateEmployeeModal();break;case"delete":t.type==="delete"&&(console.log("Row from table:",t.item),this.deleteModal(t.item));break;case"edit":this.updateCreateEmployeeModal(t.item);break;default:console.log("Unknown action type:",t.type)}}loadCreateEmployeeModal(){this.modalController.create({component:k,cssClass:"custom-modal",componentProps:{}}).then(t=>{t.present(),t.onDidDismiss().then(e=>{this.accountStore.getAccounts(),console.log("Modal dismissed with data:",e)})})}updateCreateEmployeeModal(t){console.log("Selected row data:",t),this.modalController.create({component:k,cssClass:"custom-modal",componentProps:{editData:t}}).then(e=>{e.present(),e.onDidDismiss().then(o=>{this.accountStore.getAccounts(),console.log("Modal dismissed with data:",o)})})}deleteModal(t){this.modalController.create({component:ut,cssClass:"custom-delete-modal",componentProps:{role:"delete",data:{id:t.accountId,name:t.accountName}}}).then(e=>{e.present(),e.onDidDismiss().then(o=>{o?.data?.confirmed&&this.accountStore.deleteAccount(o.data.id)})})}static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275cmp=E({type:n,selectors:[["app-account-create"]],standalone:!0,features:[F([_]),y],decls:2,vars:3,consts:[[3,"rowAction","columns","data","label"]],template:function(e,o){e&1&&(c(0,"div")(1,"app-reusable-table",0),C("rowAction",function(s){return o.handleRowAction(s)}),i()()),e&2&&(a(),p("columns",o.columns)("data",o.accountList$)("label",o.label))},dependencies:[st,I]})}}return n})();export{Jt as AccountCreateComponent};
